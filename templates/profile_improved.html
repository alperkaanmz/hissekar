{% extends 'components/base.html' %} {% load static %} {% block styles %}
<link rel="stylesheet" href="{% static 'assets/libs/glightbox/css/glightbox.min.css'%}" />

<style>
/* Modern Enhancements */
.box {
    border-radius: 15px !important;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08) !important;
    border: 1px solid rgba(0,0,0,0.05) !important;
}

.main-profile-cover {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    border-radius: 15px 15px 0 0 !important;
}

.modern-metric-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    padding: 20px;
    color: white;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    text-align: center;
    margin-bottom: 20px;
    transition: transform 0.3s ease;
}

.modern-metric-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

.modern-metric-value {
    font-size: 2rem;
    font-weight: bold;
    margin: 10px 0;
}

.modern-metric-label {
    font-size: 0.9rem;
    opacity: 0.9;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.table-responsive table {
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 15px rgba(0,0,0,0.1);
}

/* Modern Tab Styling */
.modern-tabs-container {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    padding: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.modern-tab-button {
    background: transparent !important;
    color: #6b7280 !important;
    border: none !important;
    border-radius: 12px !important;
    padding: 12px 20px !important;
    margin: 0 4px !important;
    font-weight: 500 !important;
    font-size: 0.875rem !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    position: relative !important;
    overflow: hidden !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    min-height: 44px !important;
    white-space: nowrap !important;
}

.modern-tab-button:hover {
    background: rgba(139, 92, 246, 0.1) !important;
    color: #8b5cf6 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2) !important;
}

.modern-tab-button.active,
.modern-tab-button[aria-selected="true"] {
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%) !important;
    color: white !important;
    box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4) !important;
    transform: translateY(-1px) !important;
}

.modern-tab-button.active::before,
.modern-tab-button[aria-selected="true"]::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
    border-radius: inherit;
    pointer-events: none;
}

.modern-tab-button i {
    font-size: 1rem !important;
    opacity: 0.8;
}

.modern-tab-button.active i,
.modern-tab-button[aria-selected="true"] i {
    opacity: 1;
}

/* Tab responsive */
@media (max-width: 768px) {
    .modern-tabs-container {
        padding: 6px;
        border-radius: 12px;
    }
    
    .modern-tab-button {
        padding: 10px 16px !important;
        font-size: 0.8125rem !important;
        min-height: 40px !important;
    }
    
    .modern-tab-button span {
        display: none;
    }
    
    .modern-tab-button i {
        margin: 0 !important;
    }
}

.table thead {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    color: white !important;
}

.table thead th {
    border: none !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    font-size: 0.8rem !important;
}

.table tbody tr:hover {
    background-color: rgba(102, 126, 234, 0.05) !important;
    transform: scale(1.01);
    transition: all 0.2s ease;
}

.nav-tabs .nav-link {
    border-radius: 25px !important;
    margin: 0 5px !important;
    transition: all 0.3s ease !important;
}

.nav-tabs .nav-link.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
    border-color: transparent !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3) !important;
}

/* Chart containers */
.chart-container {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    margin: 20px 0;
}

/* Animation for page load */
@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.box {
    animation: slideInUp 0.6s ease-out;
}

.box:nth-child(2) {
    animation-delay: 0.1s;
}

.box:nth-child(3) {
    animation-delay: 0.2s;
}
</style>

{% endblock %} {% block content %}

<div class="main-content">
    <!-- Page Header -->
    <div class="block justify-between page-header md:flex">
        <div>
            <h3
                class="!text-defaulttextcolor dark:!text-defaulttextcolor/70 dark:text-white dark:hover:text-white text-[1.125rem] font-semibold">
                {{stock_data.stock_name}}'s Profile
            </h3>
        </div>
        <ol class="flex items-center whitespace-nowrap min-w-0">
            <li class="text-[0.813rem] ps-[0.5rem]">
                <a class="flex items-center text-primary hover:text-primary dark:text-primary truncate"
                    href="javascript:void(0);">
                    Pages
                    <i
                        class="ti ti-chevrons-right flex-shrink-0 text-[#8c9097] dark:text-white/50 px-[0.5rem] overflow-visible rtl:rotate-180"></i>
                </a>
            </li>
            <li class="text-[0.813rem] text-defaulttextcolor font-semibold hover:text-primary dark:text-[#8c9097] dark:text-white/50"
                aria-current="page">
                Profile
            </li>
        </ol>
    </div>
    <!-- Page Header Close -->

    <!-- Start::row-1 -->
    <div class="grid grid-cols-12 gap-x-6">
        <div class="xxl:col-span-4 xl:col-span-12 col-span-12">
            <div class="box overflow-hidden">
                <div class="box-body !p-0">
                    <div class="sm:flex items-start p-6 main-profile-cover">
                        <div>
                            <span class="avatar avatar-xxl avatar-rounded me-4">
                                <img src="{% static 'assets/images/company-logos/' %}{{ symbol|slice:'0:5' }}.png"
                                    alt="">
                            </span>
                        </div>
                        <div class="flex-grow main-profile-info">
                            <div class="flex items-center !justify-between">
                                <h6 class="font-semibold mb-1 text-white text-[1rem]">{{symbol|slice:'0:5'}}</h6>
                            </div>
                            <h4 class="font-semibold mb-1 text-white text-[1rem]">{{stock_data.long_name}}</h4>
                            <p class="text-[0.75rem] text-white mb-6 opacity-[0.5]">
                                <span class="me-4 inline-flex"><i
                                        class="ri-building-line me-1 align-middle"></i>{{stock_data.country}}</span>
                                <span class="inline-flex"><i
                                        class="ri-map-pin-line me-1 align-middle"></i>{{stock_data.city}}</span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="p-6 border-b border-dashed dark:border-defaultborder/10">
                    <div class="mb-6">
                        <p class="text-[.9375rem] mb-2 font-semibold">
                            About:
                        </p>
                        <p class="text-[0.75rem] text-[#8c9097] dark:text-white/50 opacity-[0.7] mb-0">
                            <b class="text-defaulttextcolor">{{ stock_data.long_description}}</b>
                        </p>
                    </div>
                    <div class="mb-4">
                        <p class="text-[.9375rem] mb-2 font-semibold">Links:</p>
                        <div class="mb-0">
                            <p class="mb-1">
                                <a href="{{ stock_data.website }}"
                                    class="text-primary"><u>{{stock_data.website}}</u></a>
                            </p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-[.9375rem] mb-2 font-semibold">Industry:</p>
                        <div class="mb-0">
                            <p class="mb-1">
                                <span class="text-[#8c9097] dark:text-white/50 opacity-[0.7] mb-0">
                                    <b class="text-defaulttextcolor">{{stock_data.industry}}</b></span>
                            </p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-[.9375rem] mb-2 font-semibold">Sector:</p>
                        <div class="mb-0">
                            <p class="mb-1">
                                <span class="text-[#8c9097] dark:text-white/50 opacity-[0.7] mb-0">
                                    <b class="text-defaulttextcolor">{{stock_data.sector}}</b></span>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="p-6">
                    <p class="text-[.9375rem] mb-2 me-6 font-semibold">Key Executives:</p>
                    <ul class="list-group">
                        <li class="list-group-item">
                            <div class="sm:flex items-start">
                                <div class="sm:ms-2 ms-0 sm:mt-0 mt-1 font-semibold flex-grow">
                                    <p class="mb-0 leading-none">{{ stock_data.ceo }}</p>
                                    <span
                                        class="text-[.6875rem] text-[#8c9097] dark:text-white/50 opacity-[0.7]">CEO</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item">
                            <div class="sm:flex items-start">
                                <div class="sm:ms-2 ms-0 sm:mt-0 mt-1 font-semibold flex-grow">
                                    <p class="mb-0 leading-none">{{ stock_data.cfo }}</p>
                                    <span
                                        class="text-[.6875rem] text-[#8c9097] dark:text-white/50 opacity-[0.7]">CFO</span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="p-6 border-b border-dashed dark:border-defaultborder/10">
                    <p class="text-[.9375rem] mb-2 me-6 font-semibold">
                        Contact Information :
                    </p>
                    <div class="text-[#8c9097] dark:text-white/50">
                        <p class="mb-2">
                            <span
                                class="avatar avatar-sm avatar-rounded me-2 bg-light text-[#8c9097] dark:text-white/50">
                                <i
                                    class="ri-phone-line align-middle text-[.875rem] text-[#8c9097] dark:text-white/50"></i>
                            </span>
                            +{{ stock_data.phone }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="xxl:col-span-8 xl:col-span-12 col-span-12">
        <div class="grid grid-cols-12 gap-x-6">
            <div class="xl:col-span-12 col-span-12">
                <div class="box">
                    <div class="box-body !p-0">
                        <div class="!p-6">
                            <nav class="modern-tabs-container flex flex-wrap gap-2">
                                <a class="modern-tab-button active"
                                    href="javascript:void(0);" id="profitability-tab"
                                    data-hs-tab="#profitability-tab-pane" aria-controls="profitability-tab-pane">
                                    <i class="ri-bar-chart-2-line"></i>
                                    <span>Profitability Measurements</span></a>

                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="ratios-tab" data-hs-tab="#ratios-tab-pane"
                                    aria-controls="ratios-tab-pane">
                                    <i class="ri-calculator-line"></i>
                                    <span>Ratios</span></a>

                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="net-debt-tab" data-hs-tab="#net-debt-tab-pane"
                                    aria-controls="net-debt-tab-pane">
                                    <i class="ri-pie-chart-line"></i>
                                    <span>Net Debt Analysis</span></a>

                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="price-tab" data-hs-tab="#price-tab-pane"
                                    aria-controls="price-tab-pane">
                                    <i class="ri-coin-line"></i>
                                    <span>Stock Price TL</span></a>



                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="balance-sheet-tab"
                                    data-hs-tab="#balance-sheet-tab-pane" aria-controls="balance-sheet-tab-pane">
                                    <i class="ri-file-list-3-line"></i>
                                    <span>Balance Sheet</span></a>

                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="income-statement-tab"
                                    data-hs-tab="#income-statement-tab-pane" aria-controls="income-statement-tab-pane">
                                    <i class="ri-bar-chart-line"></i>
                                    <span>Income Statement</span></a>
                                <a class="modern-tab-button"
                                    href="javascript:void(0);" id="cashflow-statement-tab"
                                    data-hs-tab="#cashflow-statement-tab-pane"
                                    aria-controls="cashflow-statement-tab-pane">
                                    <i class="ri-bar-chart-line"></i>
                                    <span>Cash Flow Statement</span></a>
                            </nav>
                        </div>
                        <div class="!p-4">
                            <div class="tab-content" id="myTabContent">
                                <div class="!p-0 !border-0" id="profitability-tab-pane" role="tabpanel"
                                    aria-labelledby="profitability-tab">
                                    <div class="box-header">
                                        <div class="box custom-box">
                                            <div class="box-title">
                                                {{stock_data.stock_name}}'s Profitability Measurements
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table whitespace-nowrap min-w-full ">
                                            <thead>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="col" class="text-start">Indicator</th>
                                                    {% for date, data in stock_data.profitability_data.items %}
                                                    <th scope="col" class="text-start">{{ date }}</th>
                                                    {% endfor %}
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">Revenue</th>
                                                    {% for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {% if data.TR == "--" %}
                                                        <span style="color: orange;">{{ data.TR }}%</span>
                                                        {% elif data.TR < 0 %} <span style="color: red;">{{ data.TR }}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% elif data.TR > 0 %}
                                                            <span style="color: green;">{{ data.TR }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span>{{ data.TR }}</span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.TR }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">Gross Profit</th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.GP == "--" %}
                                                        <span style="color: orange;">{{ data.GP }}%</span>
                                                        {% elif data.GP < 0 %} <span style="color: red;">{{ data.GP }}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.GP }}%<i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.GP }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">Operating Income</th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.OI == "--"%}
                                                        <span style="color: orange;">{{ data.OI }}%</span>
                                                        {% elif data.OI < 0 %} <span style="color: red;">{{ data.OI }}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.OI }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.OI }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">NOPAT</th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.NOPAT == "--"%}
                                                        <span style="color: orange;">{{ data.NOPAT }}%</span>
                                                        {% elif data.NOPAT < 0 %} <span style="color: red;">
                                                            {{data.NOPAT}}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.NOPAT }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.NOPAT }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">EBIT</th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.EBIT == "--"%}
                                                        <span style="color: orange;">{{ data.EBIT }}%</span>
                                                        {% elif data.EBIT < 0 %} <span style="color: red;">
                                                            {{data.EBIT}}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.EBIT }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.EBIT }}
                                                            {% endif %}

                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start">EBITDA</th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.EBITDA == "--"%}
                                                        <span style="color: orange;">{{ data.EBITDA }}%</span>
                                                        {% elif data.EBITDA < 0 %} <span style="color: red;">
                                                            {{data.EBITDA}}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{data.EBITDA}}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.EBITDA }}
                                                            {% endif %}

                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start"> Net Income </th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.NI == "--"%}
                                                        <span style="color: orange;">{{ data.NI }}%</span>
                                                        {% elif data.NI < 0 %} <span style="color: red;">{{ data.NI }}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.NI }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.NI }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                                <tr class="border-b border-defaultborder">
                                                    <th scope="row" class="text-start"> FCFF </th>
                                                    {%for date, data in stock_data.profitability_data.items %}
                                                    <td>
                                                        {% if date == 'Change' %}
                                                        {%if data.FCFF == "--"%}
                                                        <span style="color: orange;">{{ data.FCFF }}%</span>
                                                        {% elif data.FCFF < 0 %} <span style="color: red;">
                                                            {{data.FCFF}}%
                                                            <i class="ri-arrow-down-s-fill ms-1"></i></span>
                                                            {% else %}
                                                            <span style="color: green;">{{ data.FCFF }}% <i
                                                                    class="ri-arrow-up-s-fill ms-1"></i></span>
                                                            {% endif %}
                                                            {% else %}
                                                            {{ data.FCFF }}
                                                            {% endif %}
                                                    </td>
                                                    {% endfor %}
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="!p-0 !border-0 hidden" id="ratios-tab-pane" role="tabpanel"
                                    aria-labelledby="ratios-tab">
                                    <div class="table-responsive">
                                        <div class="box custom-box">
                                            <div class="box-header">
                                                <div class="box-title">
                                                    {{stock_data.stock_name}}'s Ratios
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                <table class="table whitespace-nowrap min-w-full">
                                                    <thead>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="col" class="text-start">Ratios</th>
                                                            <th scope="col" class="text-start">Values</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="table-group-divider dark:border-defaultborder/10">
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">P/E</th>
                                                            <td>{{ stock_data.pe_ratio }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">Price to Book</th>
                                                            <td>{{ stock_data.price_to_book }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">EV/EBITDA</th>
                                                            <td>{{ stock_data.ev_ebitda }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">EV/FCFF</th>
                                                            <td>{{ stock_data.ev_fcff }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">ROA</th>
                                                            <td>{{ stock_data.roa }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">ROE</th>
                                                            <td>{{ stock_data.roe }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">Current Ratio</th>
                                                            <td>{{ stock_data.current_ratio }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">Quick Ratio</th>
                                                            <td>{{ stock_data.quick_ratio }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">Financial Debt/FCFF</th>
                                                            <td>{{ stock_data.total_debt_to_fcf }}</td>
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="row" class="text-start">Cash/MarketCap</th>
                                                            <td>{{ stock_data.cash_market_cap }}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            <div class="!p-0 !border-0 hidden" id="net-debt-tab-pane" role="tabpanel"
                                aria-labelledby="net-debt-tab">
                                <div class="grid grid-cols-12 gap-x-6">
                                    <div class="xl:col-span-6 col-span-12">
                                        <div class="box custom-box">
                                            <div class="box-header">
                                                <div class="box-title">{{stock_data.stock_name}}'s Net Debt Analysis
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                {{stock_data.chart_netdebt_div|safe}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="!p-0 !border-0 hidden" id="price-tab-pane" role="tabpanel"
                                aria-labelledby="price-tab">
                                <div class="grid grid-cols-16 sm:gap-x-6 gap-y-6">
                                    <div class="xl:col-span-6 col-span-16">
                                        <div class="box custom-box chart-container" style="border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08);">
                                            <div class="box-header">
                                                <div class="box-title" style="font-size: 1.2rem; font-weight: 600;">
                                                    {{stock_data.stock_name}} Stock Price Performance (TL)
                                                </div>
                                                <div class="flex gap-2 items-center">
                                                    <span class="badge bg-success-transparent text-success rounded-pill">TL</span>
                                                    <span class="badge bg-primary-transparent text-primary rounded-pill">Daily Close</span>
                                                </div>
                                            </div>
                                            <div class="box-body">
                                                <div id="stock-price-chart" 
                                                     style="width: 100%; height: 600px; border-radius: 15px; overflow: hidden;">
                                                    {{stock_data.chart_div|safe}}
                                                </div>
                                                
                                                <script>
                                                document.addEventListener('DOMContentLoaded', function() {
                                                    setTimeout(function() {
                                                        // Grafik elementini bul
                                                        const chartDiv = document.querySelector('#stock-price-chart .plotly-graph-div');
                                                        
                                                        if (chartDiv) {
                                                            // Relayout event listener ekle
                                                            chartDiv.on('plotly_relayout', function(eventdata) {
                                                                // Eğer X ekseni range değişikliği varsa
                                                                if (eventdata['xaxis.range[0]'] && eventdata['xaxis.range[1]']) {
                                                                    const startDate = new Date(eventdata['xaxis.range[0]']);
                                                                    const endDate = new Date(eventdata['xaxis.range[1]']);
                                                                    
                                                                    // Mevcut veriyi al
                                                                    const data = chartDiv.data[0];
                                                                    if (data && data.x && data.y) {
                                                                        let visibleY = [];
                                                                        
                                                                        // Görünür aralıktaki Y değerlerini topla
                                                                        for (let i = 0; i < data.x.length; i++) {
                                                                            const dataDate = new Date(data.x[i]);
                                                                            if (dataDate >= startDate && dataDate <= endDate && data.y[i] !== null) {
                                                                                visibleY.push(data.y[i]);
                                                                            }
                                                                        }
                                                                        
                                                                        // Y ekseni aralığını ayarla
                                                                        if (visibleY.length > 0) {
                                                                            const minY = Math.min(...visibleY);
                                                                            const maxY = Math.max(...visibleY);
                                                                            const padding = (maxY - minY) * 0.05; // %5 padding
                                                                            
                                                                            // Minimum padding garantisi
                                                                            const finalPadding = Math.max(padding, (maxY * 0.02));
                                                                            
                                                                            setTimeout(function() {
                                                                                Plotly.relayout(chartDiv, {
                                                                                    'yaxis.range': [minY - finalPadding, maxY + finalPadding]
                                                                                });
                                                                            }, 100);
                                                                        }
                                                                    }
                                                                }
                                                            });
                                                            
                                                            // Modebar butonlarını taşı
                                                            const modebar = chartDiv.querySelector('.modebar');
                                                            if (modebar) {
                                                                modebar.style.left = '10px';
                                                                modebar.style.top = '60px';
                                                            }
                                                        }
                                                    }, 1000);
                                                });
                                                </script>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="!p-0 !border-0 hidden" id="balance-sheet-tab-pane" role="tabpanel"
                                aria-labelledby="balance-sheet-tab">
                                <div class="grid  sm:gap-x-6 gap-y-6">
                                    <div class="box custom-box">
                                        <div class="box-header">
                                            <div class="box-title">{{stock_data.stock_name}}'s Balance Sheet</div>
                                        </div>
                                        <div class="box-body">
                                            <div class="table-responsive">
                                                <table class="table whitespace-nowrap table-bordered min-w-full">
                                                    <thead>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="colgroup" class="text-start"></th>
                                                            {% for date, data in stock_data.balance_data.items %}
                                                            <th>{{ date }}</th>
                                                            {% endfor %}
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Total Assets</strong></td>
                                                            {% for TA, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.TA}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Current Assets</strong></td>
                                                            {% for CA, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.CA }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Cash and Cash Equivalents</td>
                                                            {% for CE, data in stock_data.balance_data.items %}
                                                            <td>{{ data.CE }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Other Short Term Investments</td>
                                                            {% for OSTI, data in stock_data.balance_data.items %}
                                                            <td>{{ data.OSTI }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Inventory</td>
                                                            {% for INV, data in stock_data.balance_data.items %}
                                                            <td>{{ data.INV }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Non Current Assets</strong></td>
                                                            {% for NCA, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.NCA }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Total Liabilities</strong></td>
                                                            {% for TL, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.TL}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Current Liabilities</strong></td>
                                                            {% for CL, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.CL }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Short Term Debt</td>
                                                            {% for STD, data in stock_data.balance_data.items %}
                                                            <td>{{ data.STD }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Non Current Liabilities</strong></td>
                                                            {% for NCL, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.NCL }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Long Term Debt</td>
                                                            {% for LTD, data in stock_data.balance_data.items %}
                                                            <td>{{ data.LTD }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Total Shareholder's Equity</strong></td>
                                                            {% for TSE, data in stock_data.balance_data.items %}
                                                            <td><strong>{{ data.TSE }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Minority Interest</td>
                                                            {% for MI, data in stock_data.balance_data.items %}
                                                            <td>{{ data.MI }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Common Stock</td>
                                                            {% for CS, data in stock_data.balance_data.items %}
                                                            <td>{{ data.CS}}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Retained Earnings</td>
                                                            {% for RE, data in stock_data.balance_data.items %}
                                                            <td>{{ data.RE }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Treasury Stock</td>
                                                            {% for TS, data in stock_data.balance_data.items %}
                                                            <td>{{ data.TS }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Net Working Capital</td>
                                                            {% for NWC, data in stock_data.balance_data.items %}
                                                            <td>{{ data.NWC }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Financial Debt</td>
                                                            {% for FD, data in stock_data.balance_data.items %}
                                                            <td>{{ data.FD }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Net Debt</td>
                                                            {% for ND, data in stock_data.balance_data.items %}
                                                            <td>{{ data.ND }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Operational NWC</td>
                                                            {% for ON, data in stock_data.balance_data.items %}
                                                            <td>{{ data.ON }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Change in Operational NWC</td>
                                                            {% for CONW, data in stock_data.balance_data.items %}
                                                            <td>{{ data.CONW }}</td> {% endfor %}
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="!p-0 !border-0 hidden" id="income-statement-tab-pane"
                                role="tabpanel" aria-labelledby="income-statement-tab">
                                <div class="grid sm:gap-x-6 gap-y-6">
                                    <div class="box custom-box">
                                        <div class="box-header">
                                            <div class="box-title">
                                                {{stock_data.stock_name}}'s Income Statement
                                            </div>
                                        </div>
                                        <div class="box-body">
                                            <div class="table-responsive">
                                                <table class="table whitespace-nowrap table-bordered min-w-full">
                                                    <thead>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="colgroup" class="text-start"></th>
                                                            {% for date, data in stock_data.income_data.items %}
                                                            <th>{{ date }}</th>
                                                            {% endfor %}
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Sales Revenue</strong></td>
                                                            {% for SR, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.SR}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>COGS</td>
                                                            {% for COGS, data in stock_data.income_data.items %}
                                                            <td>{{ data.COGS }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Gross Profit</strong></td>
                                                            {% for GP, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.GP}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>OPEX</td>
                                                            {% for OPEX, data in stock_data.income_data.items %}
                                                            <td>{{ data.OPEX }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>General & Administrative Expense</td>
                                                            {% for GAA, data in stock_data.income_data.items %}
                                                            <td>{{ data.GAA }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Selling & Marketing Expense</td>
                                                            {% for SM, data in stock_data.income_data.items %}
                                                            <td>{{ data.SM }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Operating Profit</strong></td>
                                                            {% for OP, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.OP }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>EBIT</strong></td>
                                                            {% for EBIT, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.EBIT}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>EBITDA</strong></td>
                                                            {% for EBITDA, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.EBITDA}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Profit Before Tax</td>
                                                            {% for PBT, data in stock_data.income_data.items %}
                                                            <td>{{ data.PBT}}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Tax Provision</td>
                                                            {% for TP, data in stock_data.income_data.items %}
                                                            <td>{{ data.TP}}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Net Income</strong></td>
                                                            {% for NI, data in stock_data.income_data.items %}
                                                            <td><strong>{{ data.NI}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Depreciation and Amortization</td>
                                                            {% for DA, data in stock_data.income_data.items %}
                                                            <td>{{ data.DA}}</td> {% endfor %}
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="!p-0 !border-0 hidden" id="cashflow-statement-tab-pane"
                                role="tabpanel" aria-labelledby="cashflow-statement-tab">
                                <div class="grid sm:gap-x-6 gap-y-6">
                                    <div class="box custom-box">
                                        <div class="box-header">
                                            <div class="box-title">
                                                {{stock_data.stock_name}}'s Cash Flow Statement
                                            </div>
                                        </div>
                                        <div class="box-body">
                                            <div class="table-responsive">
                                                <table class="table table whitespace-nowrap table-bordered min-w-full">
                                                    <thead>
                                                        <tr class="border-b border-defaultborder">
                                                            <th scope="colgroup" class="text-start"></th>
                                                            {% for date, data in stock_data.cash_flow.items %}
                                                            <th>{{ date }}</th>
                                                            {% endfor %}
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Cash Flow From Operating Activities</strong>
                                                            </td>
                                                            {% for CFFOA, data in stock_data.cash_flow.items %}
                                                            <td><strong>{{ data.CFFOA}}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Cash Flow From Investing Activities</strong>
                                                            </td>
                                                            {% for CFFIA, data in stock_data.cash_flow.items %}
                                                            <td><strong>{{ data.CFFIA }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>Cash Flow From Financing Activities</strong>
                                                            </td>
                                                            {% for CFFFA, data in stock_data.cash_flow.items %}
                                                            <td><strong>{{ data.CFFFA }}</strong></td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>End Cash Position</td>
                                                            {% for ECP, data in stock_data.cash_flow.items %}
                                                            <td>{{ data.ECP }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Changes in Cash</td>
                                                            {% for CIC, data in stock_data.cash_flow.items %}
                                                            <td>{{ data.CIC }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Effect of Exchange Rate Changes</td>
                                                            {% for EOERC, data in stock_data.cash_flow.items %}
                                                            <td>{{ data.EOERC }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td>Beginning Cash Position</td>
                                                            {% for BCP, data in stock_data.cash_flow.items %}
                                                            <td>{{ data.BCP }}</td> {% endfor %}
                                                        </tr>
                                                        <tr class="border-b border-defaultborder">
                                                            <td><strong>CAPEX</strong></td>
                                                            {% for CAPEX, data in stock_data.cash_flow.items %}
                                                            <td><strong>{{ data.CAPEX }}</strong></td> {% endfor %}
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

{% endblock %} {% block scripts %}
<script src="{% static 'assets/js/maindeneme.js' %}"></script>

<!-- Gallery JS -->
<script src="{% static 'assets/libs/glightbox/js/glightbox.min.js'%}"></script>

<!-- Internal Profile JS -->
<script src="{% static 'assets/js/profile.js'%}"></script>
{% endblock %}